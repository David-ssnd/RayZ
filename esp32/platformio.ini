[platformio]
default_envs = target
src_dir = . ; Default to root, overridden by extra_script.py per environment

; Root unified PlatformIO configuration for RayZ Target & Weapon
; Clean multi-environment layout with environment-specific src linking

[env:base]
platform = espressif32@6.12.0
framework = espidf
board_build.partitions = shared/partitions/huge_app.csv
board_build.extra_component_dirs = shared
monitor_speed = 115200
upload_speed = 921600
extra_scripts = pre:extra_script.py

[env:target]
extends = env:base
board = esp32dev
board_build.esp-idf.sdkconfig_path = sdkconfig.target
custom_src_dir = target/src
build_flags = 
    -DROLE_TARGET
    -DRAYZ_VERSION=\"1.0.0\"
upload_port = COM3
monitor_port = COM3

[env:weapon]
extends = env:base
board = esp32-c3-devkitm-1
board_build.esp-idf.sdkconfig_path = sdkconfig.weapon
custom_src_dir = weapon/src
build_flags = 
    -DROLE_WEAPON
    -DRAYZ_VERSION=\"1.0.0\"
upload_port = COM7
monitor_port = COM7
monitor_dtr = 0
monitor_rts = 0

; Commands:
;   pio run -e target
;   pio run -e weapon
;   pio run -e target -t upload
;   pio run -e weapon -t upload
;   pio device monitor -e target
;   pio device monitor -e weapon
